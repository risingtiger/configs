const parseCsv=(file)=>new Promise(async(res,rej)=>{let parsedCsv=[];try{const text=await file.text();const lines=text.split('\n').map((l)=>l.trim()).filter((l)=>l);if(lines.length<2){alert('CSV file must have at least a header and one data line.');return}const dataLines=lines.slice(2);parsedCsv=dataLines.map((line)=>{const cols=line.split('\t').map((c)=>c.trim().replace(/^"|"$/g,''));const chipid_raw=cols[2]||'';const chipids=chipid_raw.includes('/')?chipid_raw.split('/').map((c)=>c.trim().padStart(7,'0')).sort():chipid_raw?[chipid_raw.padStart(7,'0')]:[];const machineid_raw=cols[3]||'';let machineids=machineid_raw.includes('/')?machineid_raw.split("/").map((c)=>c.trim().padStart(7,'0')).sort():machineid_raw?[machineid_raw.padStart(7,'0')]:[];return{nwsid:(cols[0]||'').padStart(7,'0'),storeid:(cols[1]||'').padStart(7,'0'),chipids:chipids,machineids:machineids,storename:cols[4]||'',equipment:cols[5]||'',watertype:cols[6]||'',address:cols[7]||'',city:cols[8]||'',state:cols[9]||'',zip:cols[10]||''}});res(parsedCsv)}catch(error){rej(error)}});const Utils={parseCsv};export{Utils}